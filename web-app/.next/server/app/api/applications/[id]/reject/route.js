"use strict";(()=>{var e={};e.id=725,e.ids=[725],e.modules={11185:e=>{e.exports=require("mongoose")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},80066:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>f,originalPathname:()=>y,patchFetch:()=>S,requestAsyncStorage:()=>m,routeModule:()=>u,serverHooks:()=>h,staticGenerationAsyncStorage:()=>g,staticGenerationBailout:()=>v});var n={};r.r(n),r.d(n,{POST:()=>l});var o=r(6170),a=r(8533),i=r(54387),s=r(40064),p=r(30611),d=r(26760),c=r(90743);async function l(e,{params:t}){try{await (0,p.v)();let e=await d.Z.findByIdAndUpdate(t.id,{status:"rejected",reviewedAt:new Date},{new:!0});if(!e)return s.Z.json({error:"Application not found"},{status:404});if(e.telegramId){let t=`❌ <b>Candidature refus\xe9e</b>

Malheureusement, votre candidature n'a pas \xe9t\xe9 accept\xe9e.

Cela peut \xeatre d\xfb \xe0 :
• Informations incompl\xe8tes
• Non-respect des crit\xe8res
• Zones de service limit\xe9es

Vous pouvez soumettre une nouvelle candidature avec des informations compl\xe8tes.`;await (0,c.T)(e.telegramId,t)}return s.Z.json({success:!0})}catch(e){return console.error("Reject application error:",e),s.Z.json({error:"Failed to reject application"},{status:500})}}let u=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/applications/[id]/reject/route",pathname:"/api/applications/[id]/reject",filename:"route",bundlePath:"app/api/applications/[id]/reject/route"},resolvedPagePath:"/workspace/web-app/app/api/applications/[id]/reject/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:m,staticGenerationAsyncStorage:g,serverHooks:h,headerHooks:f,staticGenerationBailout:v}=u,y="/api/applications/[id]/reject/route";function S(){return(0,i.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:g})}},30611:(e,t,r)=>{r.d(t,{v:()=>s});var n=r(11185),o=r.n(n);let a=process.env.MONGODB_URI;if(!a)throw Error("Please define the MONGODB_URI environment variable");let i=global.mongoose||{conn:null,promise:null};async function s(){if(i.conn)return i.conn;i.promise||(i.promise=o().connect(a,{bufferCommands:!1}));try{i.conn=await i.promise}catch(e){throw i.promise=null,e}return i.conn}global.mongoose||(global.mongoose=i)},90743:(e,t,r)=>{r.d(t,{T:()=>n});async function n(e,t){let r=process.env.TELEGRAM_BOT_TOKEN,n=`https://api.telegram.org/bot${r}/sendMessage`;try{let r=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chat_id:e,text:t,parse_mode:"HTML"})}),o=await r.json();if(!o.ok)return console.error("Failed to send Telegram message:",o),!1;return!0}catch(e){return console.error("Error sending Telegram message:",e),!1}}},26760:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(11185),o=r.n(n);let a=new(o()).Schema({userId:{type:o().Schema.Types.ObjectId,ref:"User",required:!0},telegramId:{type:Number,required:!0},username:String,socialNetworks:{primary:[String],links:{type:Map,of:String},others:String},methods:{delivery:Boolean,shipping:Boolean,meetup:Boolean},deliveryZones:String,shippingZones:String,meetupZones:String,country:String,department:String,postalCode:String,photo:String,description:String,location:{country:String,department:String,postalCode:String},shopPhoto:String,status:{type:String,enum:["pending","approved","rejected"],default:"pending"},createdAt:{type:Date,default:Date.now},submittedAt:{type:Date,default:Date.now},reviewedAt:Date,reviewedBy:String}),i=o().models.VendorApplication||o().model("VendorApplication",a)}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[864,386],()=>r(80066));module.exports=n})();
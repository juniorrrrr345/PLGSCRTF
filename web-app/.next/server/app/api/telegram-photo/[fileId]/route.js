"use strict";(()=>{var e={};e.id=532,e.ids=[532],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},98373:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>g,originalPathname:()=>h,patchFetch:()=>m,requestAsyncStorage:()=>u,routeModule:()=>p,serverHooks:()=>d,staticGenerationAsyncStorage:()=>c,staticGenerationBailout:()=>f});var o={};t.r(o),t.d(o,{GET:()=>l});var a=t(6170),i=t(8533),s=t(54387),n=t(40064);async function l(e,{params:r}){try{let e=r.fileId;if(!e)return n.Z.json({error:"File ID is required"},{status:400});console.log(`📸 Fetching Telegram photo with ID: ${e}`);let t=process.env.TELEGRAM_BOT_TOKEN;if(!t)return console.error("❌ TELEGRAM_BOT_TOKEN not configured"),n.Z.json({error:"Bot token not configured"},{status:500});let o=`https://api.telegram.org/bot${t}/getFile?file_id=${e}`,a=await fetch(o),i=await a.json();if(console.log("\uD83D\uDCF8 Telegram API response:",JSON.stringify(i)),!i.ok)return console.error("❌ Telegram API error:",i.description),n.Z.json({error:i.description||"Failed to get file from Telegram"},{status:400});if(!i.result?.file_path)return console.error("❌ No file_path in response"),n.Z.json({error:"No file path returned by Telegram"},{status:500});let s=`https://api.telegram.org/file/bot${t}/${i.result.file_path}`,l=await fetch(s);if(!l.ok)return console.error("❌ Failed to download image:",l.status),n.Z.json({error:"Failed to download image from Telegram"},{status:l.status});let p=await l.arrayBuffer(),u=i.result.file_path.split(".").pop()?.toLowerCase();return console.log("✅ Successfully fetched photo"),new Response(p,{headers:{"Content-Type":"png"===u?"image/png":"image/jpeg","Cache-Control":"public, max-age=86400"}})}catch(e){return console.error("❌ Error fetching Telegram photo:",e),n.Z.json({error:"Failed to fetch photo",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}let p=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/telegram-photo/[fileId]/route",pathname:"/api/telegram-photo/[fileId]",filename:"route",bundlePath:"app/api/telegram-photo/[fileId]/route"},resolvedPagePath:"/workspace/web-app/app/api/telegram-photo/[fileId]/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:u,staticGenerationAsyncStorage:c,serverHooks:d,headerHooks:g,staticGenerationBailout:f}=p,h="/api/telegram-photo/[fileId]/route";function m(){return(0,s.patchFetch)({serverHooks:d,staticGenerationAsyncStorage:c})}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[864,386],()=>t(98373));module.exports=o})();